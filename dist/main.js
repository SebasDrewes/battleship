(()=>{"use strict";var e=function(e,a,t){var r={},o=a,i=t;if("horizontal"===i)for(var n=0;n<a;n+=1)r[e+n]="noHit";else if("vertical"===i)for(var l=0;l<11*a;l+=11)r[e+l]="noHit";return{hitPoints:r,hit:function(e){r[e]="hit"},isSunk:function(){return!!Object.values(r).every((function(e){return"hit"===e}))},shipLength:o}};var a="",t="",r="",o=document.querySelector("#playerBoard"),i=document.querySelector("#enemyBoard"),n=document.querySelector("#tuRadar"),l=document.querySelector("#enemyRadar"),s=document.querySelector("#enemyRadarMobile"),d=document.querySelector("#text"),c=document.querySelector("#change"),u=document.querySelector("#title"),h=document.querySelector("#puertaCorrediza"),m=document.querySelector("#newGame"),g=document.querySelector("#winWrap"),v=function(e){e.matches||setTimeout((function(){h.style.width="100%",u.textContent="Batalla Naval"}),5e3),setTimeout((function(){window.location.reload()}),6e3)},f=window.matchMedia("(max-width: 1050px)");function B(e,a){return e.some((function(e){return a.includes(e)}))}var p=function e(n,l){for(c.style.display="none",i.style.display="grid";o.firstChild;)o.removeChild(o.firstChild);for(;i.firstChild;)i.removeChild(i.firstChild);for(var s=function(s,d,c){var h=document.createElement("div");h.textContent=s,h.classList.add("cellHittable"),h.classList.add("cellHidden"),h.setAttribute("data",[d]),!1===[10,21,32,43,54,65,76,87,98,109].includes(d)&&(h.classList.remove("cellHidden"),c?(i.appendChild(h),h.addEventListener("click",(function(){if(function(e,o,i){function n(e,a){return e.some((function(e){return a===e}))}if("hit"!==o.gameBoard[i]&&"noHit"!==o.gameBoard[i]){o.receiveAttack(i);for(var l=[10,21,32,43,54,65,76,87,98,109],s=[],d=0;d<e.gameBoard.length;d+=1)"hit"!==e.gameBoard[d]&&"noHit"!==e.gameBoard[d]&&!1===n(l,e.gameBoard[d])&&s.push(d);if("hit"===e.gameBoard[a]){if(s=[],t=a,""!==e.gameBoard[a-1]&&isNaN(e.gameBoard[a-1])||!1!==n(l,e.gameBoard[a-1])||s.push(a-1),""!==e.gameBoard[a+1]&&isNaN(e.gameBoard[a+1])||!1!==n(l,e.gameBoard[a+1])||s.push(a+1),""!==e.gameBoard[a+11]&&isNaN(e.gameBoard[a+11])||!1!==n(l,e.gameBoard[a+11])||s.push(a+11),""!==e.gameBoard[a-11]&&isNaN(e.gameBoard[a-11])||!1!==n(l,e.gameBoard[a-11])||s.push(a-11),!s[0])for(var c=0;c<e.gameBoard.length;c+=1)"hit"!==e.gameBoard[c]&&"noHit"!==e.gameBoard[c]&&!1===n(l,e.gameBoard[c])&&s.push(c)}else if("hit"===e.gameBoard[t]&&"hit"===e.gameBoard[a]){s=[],r=t;var u=t-a;t=a,11===u?(""!==e.gameBoard[a-11]&&isNaN(e.gameBoard[a-11])||!1!==n(l,e.gameBoard[a-11])||s.push(a-11),""!==e.gameBoard[a+11]&&isNaN(e.gameBoard[a+11])||!1!==n(l,e.gameBoard[a+11])||s.push(a+11)):1===u&&(""!==e.gameBoard[a-1]&&isNaN(e.gameBoard[a-1])||!1!==n(l,e.gameBoard[a-1])||s.push(a-1),""!==e.gameBoard[a+1]&&isNaN(e.gameBoard[a+1])||!1!==n(l,e.gameBoard[a+1])||s.push(a+1))}else if("hit"===e.gameBoard[t]&&"noHit"===e.gameBoard[a]){if(s=[],r=t,""!==e.gameBoard[t-1]&&isNaN(e.gameBoard[t-1])||!1!==n(l,e.gameBoard[t-1])||s.push(t-1),""!==e.gameBoard[t+1]&&isNaN(e.gameBoard[t+1])||!1!==n(l,e.gameBoard[t+1])||s.push(t+1),""!==e.gameBoard[t+11]&&isNaN(e.gameBoard[t+11])||!1!==n(l,e.gameBoard[t+11])||s.push(t+11),""!==e.gameBoard[t-11]&&isNaN(e.gameBoard[t-11])||!1!==n(l,e.gameBoard[t-11])||s.push(t-11),!s[0])for(var h=0;h<e.gameBoard.length;h+=1)"hit"!==e.gameBoard[h]&&"noHit"!==e.gameBoard[h]&&!1===n(l,e.gameBoard[h])&&s.push(h)}else if("hit"===e.gameBoard[r]&&"noHit"===e.gameBoard[a]&&(s=[],""!==e.gameBoard[r-1]&&isNaN(e.gameBoard[r-1])||!1!==n(l,e.gameBoard[r-1])||s.push(r-1),""!==e.gameBoard[r+1]&&isNaN(e.gameBoard[r+1])||!1!==n(l,e.gameBoard[r+1])||s.push(r+1),""!==e.gameBoard[r+11]&&isNaN(e.gameBoard[r+11])||!1!==n(l,e.gameBoard[r+11])||s.push(r+11),""!==e.gameBoard[r-11]&&isNaN(e.gameBoard[r-11])||!1!==n(l,e.gameBoard[r-11])||s.push(r-11),!s[0]))for(var m=0;m<e.gameBoard.length;m+=1)"hit"!==e.gameBoard[m]&&"noHit"!==e.gameBoard[m]&&!1===n(l,e.gameBoard[m])&&s.push(m);var g=s[Math.floor(Math.random()*s.length)];a=g,e.receiveAttack(g)}}(n,l,d),e(n,l),null!==h.textContent.match(/^[0-9]+$/))for(var o=0;o<l.shipList.length;o+=1){if(h.textContent===l.shipList[o].shipNumber.toString()&&!0===l.shipList[o].isSunk()){u.textContent="¡Hundiste un barco enemigo!";break}u.textContent="¡Le diste a un barco enemigo!"}else""===h.textContent&&(u.textContent="¡Fallaste el tiro!");l.allShipsSunked()?(u.textContent="Ganaste!!!",g.style.display="block",v(f)):n.allShipsSunked()&&(u.textContent="Perdiste!",g.style.display="block",v(f))})),h.addEventListener("mouseover",(function(){h.classList.add("hoverCell")})),h.addEventListener("mouseleave",(function(){h.classList.remove("hoverCell")})),"hit"===h.textContent?h.classList.add("cellShipHitted"):"noHit"===h.textContent&&h.classList.add("cellMiss")):(o.appendChild(h),h.classList.remove("cellHittable"),h.classList.add("cellFriendly"),null!==h.textContent.match(/^[0-9]+$/)?h.classList.add("cellShip"):"hit"===h.textContent?h.classList.add("cellShipHittedFriendly"):"noHit"===h.textContent&&h.classList.add("cellMissFriendly")))},d=0;d<n.gameBoard.length;d+=1)s(n.gameBoard[d],d,!1);for(var h=0;h<l.gameBoard.length;h+=1)s(l.gameBoard[h],h,!0)},y="horizontal";c.addEventListener("click",(function(){y="horizontal"===y?"vertical":"horizontal"})),document.querySelector("#github").addEventListener("click",(function(){window.open("https://github.com/SebasDrewes/","_blank")})),m.addEventListener("click",(function(){h.style.width="0%",m.style.display="none"}));var C=function(){var a=[],t=["","","","","","","","","","",10,"","","","","","","","","","",21,"","","","","","","","","","",32,"","","","","","","","","","",43,"","","","","","","","","","",54,"","","","","","","","","","",65,"","","","","","","","","","",76,"","","","","","","","","","",87,"","","","","","","","","","",98,"","","","","","","","","","",109],r=[10,21,32,43,54,65,76,87,98,109];function o(e,a){return e.some((function(e){return a.includes(e)}))}var i=function(i,n,l){var s=[];if("horizontal"===l){for(var d=i;d<i+n;d+=1)!1===s.includes(d)&&s.push(d);if(!1===o(r,s)&&i+n<120){var c=e(i,n,l);a.push(c);for(var u=i;u<i+n;u+=1)!1===r.includes(u)&&r.push(u);for(var h=0;h<c.shipLength;h+=1)t[i+h]=i;c.shipNumber=i}}else if("vertical"===l){for(var m=i;m<i+11*n;m+=11)!1===s.includes(m)&&s.push(m);if(!1===o(r,s)&&i+11*n<120){var g=e(i,n,l);a.push(g);for(var v=i;v<i+11*n;v+=11)!1===r.includes(v)&&r.push(v);for(var f=0;f<11*g.shipLength;f+=11)t[i+f]=i;g.shipNumber=i}}};return{placeShip:i,receiveAttack:function(e){if(""!==t[e])for(var r=0;r<a.length;r+=1)a[r].shipNumber===t[e]&&(t[e]="hit",a[r].hit(e));else t[e]="noHit"},gameBoard:t,shipList:a,allShipsSunked:function(){return!!a.every((function(e){return!0===e.isSunk()}))},placeShipsRandomly:function(){switch(Math.floor(5*Math.random()+1)){case 1:i(0,5,"horizontal"),i(44,4,"vertical"),i(7,3,"horizontal"),i(36,3,"vertical"),i(96,2,"horizontal");break;case 2:i(0,5,"vertical"),i(47,4,"vertical"),i(17,3,"horizontal"),i(74,3,"vertical"),i(93,2,"horizontal");break;case 3:i(27,5,"horizontal"),i(58,4,"vertical"),i(12,3,"horizontal"),i(83,3,"horizontal"),i(99,2,"horizontal");break;case 4:i(16,5,"vertical"),i(56,4,"vertical"),i(52,3,"vertical"),i(12,3,"vertical"),i(8,2,"vertical");break;case 5:i(78,5,"horizontal"),i(34,4,"horizontal"),i(50,3,"horizontal"),i(15,3,"horizontal"),i(95,2,"horizontal");break;default:i(0,5,"horizontal"),i(44,4,"vertical"),i(7,3,"horizontal"),i(36,3,"vertical"),i(96,2,"horizontal")}}}},L=C(),N=C();N.placeShipsRandomly(),function e(a,t,r){for(;o.firstChild;)o.removeChild(o.firstChild);for(var i=function(i,c){var h=document.createElement("div"),m=[10,21,32,43,54,65,76,87,98,109];h.setAttribute("data",[c]),h.classList.add("cellHidden"),h.classList.add("cell"),h.textContent=i,o.appendChild(h),!1===m.includes(c)&&(h.classList.remove("cellHidden"),h.addEventListener("click",(function(){switch(a.placeShip(c,r,y),a.shipList.length){case 1:e(a,t,4);break;case 2:case 3:e(a,t,3);break;case 4:e(a,t,2);break;case 5:p(a,t),u.textContent="Esperando instrucciones...",d.style.display="none",function(e){e.matches?(s.style.display="block",u.style.fontSize="2.5em",n.style.display="block"):(n.style.display="block",l.style.display="block")}(f);break;default:e(a,t,5)}for(var o=c;o<c+r;o+=1)m.push(o);for(var i=document.querySelectorAll(".cell"),h=0;h<i.length;h+=1)""!==i[h].textContent&&i[h].classList.add("cellShip")})),h.addEventListener("mouseover",(function(){var e=document.querySelectorAll(".cell"),a=[];if("horizontal"===y){for(var t=0;t<e.length;t+=1)if(e[t].getAttribute("data")===c.toString()){for(var o=0;o<r;o+=1)!1===a.includes(t+o)&&a.push(t+o);for(var i=0;i<r;i+=1){var n=a.every((function(a){return void 0!==e[a]&&""===e[a].textContent}));!1===B(m,a)&&n?e[t+i]&&e[t+i].classList.add("hoverCell"):e[t].classList.add("invalidCell")}}}else for(var l=0;l<e.length;l+=1)if(e[l].getAttribute("data")===c.toString()){for(var s=0;s<11*r;s+=11)!1===a.includes(l+s)&&a.push(l+s);for(var d=0;d<11*r;d+=11){var u=a.every((function(a){return void 0!==e[a]&&""===e[a].textContent}));!1===B(m,a)&&u?e[l+d]&&e[l+d].classList.add("hoverCell"):e[l].classList.add("invalidCell")}}})),h.addEventListener("mouseleave",(function(){var e=document.querySelectorAll(".cell");e.forEach((function(e){return e.classList.remove("hoverCell")})),e.forEach((function(e){return e.classList.remove("invalidCell")}))})))},c=0;c<a.gameBoard.length;c+=1)i(a.gameBoard[c],c)}(L,N,5)})();